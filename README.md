## HMAC: подпись и проверка сообщений

Минимальный сервис для подписи и проверки целостности сообщений по алгоритму HMAC-SHA256. Секрет хранится в `config.json` в кодировке base64url (без паддинга).

### Требования
- Python 3.12+
- [uv](https://github.com/astral-sh/uv) для управления зависимостями

### Установка зависимостей
```bash
make sync
```

### Формат `config.json`
```json
{
  "hmac_alg": "SHA256",
  "secret": "<base64url-no-padding>",
  "log_level": "info",
  "listen": "0.0.0.0:8080",
  "max_msg_size_bytes": 1048576
}
```
> Секрет должен быть в base64url без символов `=`. Для Unix рекомендуется ограничить доступ к файлу `config.json` правами `600`.

Для ротации секрета используйте утилиту:
```bash
uv run python -m src.rotate_secret
```

### Запуск сервера
```bash
make run/api
```
Адрес берётся из `listen` в конфиге (по умолчанию `0.0.0.0:8080`).

### Примеры запросов
Подписать сообщение:
```bash
curl -sS -X POST http://localhost:8080/sign \
  -H 'Content-Type: application/json' \
  -d '{"msg":"hello"}'
```

Проверить подпись:
```bash
curl -sS -X POST http://localhost:8080/verify \
  -H 'Content-Type: application/json' \
  -d '{"msg":"hello","signature":"<подпись из /sign>"}'
```

### Тесты
```bash
make test
```

### Ограничения реализации
- HMAC — симметричный MAC, не юридически значимая ЭП.
- Нет скрытия содержимого, только проверка целостности и аутентичности при знании секрета.
- Одна пара «отправитель‑проверяющий», многоключевой режим не реализован.
- Требуется безопасное хранение и ротация секрета.

Автор: Ахметзянов Дамир
